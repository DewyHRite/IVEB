<!DOCTYPE html>
<html>
  <head>
    <title>Product Page</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
          margin: 0;
          padding: auto;
          font-family: 'Poppins', sans-serif;
        }
    
        .header {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          z-index: 1001; /* Ensure header is above other elements */

        }

        .navbar {
          position: fixed; /* Sticks the navbar to a fixed position */
          display: flex;
          align-items: center;
          justify-content: space-between;
          max-width: auto;
          left: 0;
          right: 0;
          margin: 0 auto;
          padding: 20px 200px;
          z-index: 1002; ;
          opacity: 1;
          background-color:  #000000; /* Add background color to navbar */
          height: 60px; /* Fixed height for the navbar */
        }

        .navbar .logo a {
          font-size: 1.9rem;
          text-decoration: none;
          color: #00458b;
        }

        .navbar .links {
          display: flex;
          align-items: center;
          list-style: none;
          gap: 35px;
        }

        .navbar .links a {
          font-weight: 500;
          text-decoration: none;
          color: #fff;
          padding: 10px 0;
          transition: 0.2s ease;
        }

        .navbar .links a:hover {
          color: #00458b;
        }

        .navbar .buttons a {
          text-decoration: none;
          color: #fff;
          font-size: 1rem;
          padding: 15px 0;
          transition: 0.2s ease;
        }

        .navbar .buttons a:not(:last-child) {
          margin-right: 30px;
        }


        /* Hamburger menu styles */
        #menu-toggle {
          display: none;
        }

        #hamburger-btn {
          font-size: 1.8rem;
          color: #fff;
          cursor: pointer;
          display: none;
          order: 1;
        }

        @media screen and (max-width: 1023px) {
          .navbar .logo a {
            font-size: 1.5rem;
          }

          .links {
            position: fixed;
            left: -100%;
            top: 75px;
            width: 100%;
            height: 100vh;
            padding-top: 50px;
            background: #000000;
            flex-direction: column;
            transition: 0.3s ease;
          }

          .navbar #menu-toggle:checked ~ .links {
            left: 0;
          }

          .navbar #hamburger-btn {
            display: block;
          }

          .header .buttons {
            display: none;
          }
        }

        body{
          height: auto;
          width: auto;
          zoom: 80%; /* Adjust the zoom to 80% */
          margin-top: 80px; /* Add this line to push the content below the navbar */
          font-family: Arial, sans-serif;
          padding: 20px;
          background: linear-gradient(-45deg, #3fd2c7, #99ddff, #00458b, #3fd2c7);
          background-size: 400% 400%; /* Ensure smooth animation */
          animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        html, body {
          height: 100vh;
          width: 100%;
        }

        .container {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          align-items: center;
          gap: 50px;
          margin-top: 50px;
          width: 100%; /* Set the desired width */
          height: 700px; /* Set the desired height */
          padding: 10px; /* Optional: adds padding inside the container */
        }
        
        .product-card {
          width: 300px;
          border-radius: 10px;
          -webkit-box-shadow:  0px 0px 47px -20px rgba(0,0,0,1);
          -moz-box-shadow:  0px 0px 47px -20px rgba(0,0,0,1);
          box-shadow:  0px 0px 47px -20px #3fd2c7;
          margin: 60px 0px 60px 0px;
          background-color: #99ddff;
        }

        .product-image {
          height: 300px;
          overflow: visible;
          position: relative;
          top:-80px;
          padding: 10px;
        }

        .product-image img {
          width: 100%;
          height: 80%;
          object-fit: cover;
          transition: transform 0.5s;
          border-radius: 15px;
        }

        .product-image:hover img {
          transform: scale(1.1);
        }

        .product-details {
          padding: 20px;
          margin-top:-90px;
        }

        .product-title {
          font-size: 1.5rem;
          margin-bottom: 10px;
        }

        .product-price {
          font-size: 1.25rem;
          font-weight: bold;
          margin-bottom: 10px;
        }

        .product-description {
          font-size: 1rem;
          line-height: 1.5;
          margin-bottom: 10px;
          color: #000000;
        }

        .product-details.expand {
          height: auto;
        }

        .product-details .expand-button:hover {
          color: #99ddff;
          text-decoration: underline;
        }
        
        .buttons {
          display: flex;
          justify-content: center;
          align-items: center;
          background-color: #00458b; /* Background color */
          padding: 10px ; /* Padding for size */
          border-radius: 10px; /* Rounded corners */
          font-weight: bold; /* Bold text */
          box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1); /* Add shadow for depth */
          transition: all 0.3s ease-in-out; /* Smooth animation */
        }
        
        .buttons button {
          color: #99ddff; /* Text color same as background color */
          background-color: transparent; /* Transparent background */
          border: none; /* Remove border */
          cursor: pointer; /* Pointer cursor on hover */
        }

        .buttons button:hover {
          color: #99ddff; /* Change text color on hover */
        }

        .cart {
          position: fixed; /* Sticks the navbar to a fixed position */
          display: flex;
          align-items: center;
          justify-content: center;
          align-items: center;
          background-color: #000000; /* Background color */
          padding: 80px 20px; /* Padding for size */
          border-radius: 50px; /* Rounded corners */
          font-weight: bold; /* Bold text */
          margin-top: 100px;
          width: auto; /* Adjust width dynamically */
          max-width: auto; /* Ensure it doesn't exceed the viewport width */
        }
    </style>
  </head>
  <body>

    <div>
      <header class="header">
        <nav class="navbar">
          <nav class="navbar">
          <img width="5%" height="auto" src="Assets/LogoB.png" alt="Picture not found" style="margin-right: 100px;"/>
          <h3 class="logo"><a align="left">Island Vybz Electric Bikes</a></h3>
          <input type="checkbox" id="menu-toggle" />
          <label for="menu-toggle" id="hamburger-btn">
            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24">
              <path d="M3 12h18M3 6h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </label>
          <ul class="links">
            <li>
              <div class="buttons">
                <button onclick="checkout()" class="carticon" style="white-space: nowrap; color: #000000;">Cart
                  <i class="fas fa-shopping-cart"></i>
                  <span class="cart-count" id="cart-count">0</span>
                </button>                
              </div>
            </li>
            <li style="white-space: nowrap;"><a href="AboutUs.html">About Us</a></li>
            <li>
              <div>
                <a href="Login.html">Logout</a>
              </div>
            </li>
          </ul>
        </nav>
      </header>
    </div>

    <table border="0" align="left" >
      <tr>
        <td width="15%">
        </td>
        <td>
          <div class="container">
            <div class="product-card">
              <div class="product-image">
                <img src="Assets/Bike1_.jpg" alt="Product Image">
              </div>
              <div class="product-details">
                <h2 class="product-title">Standard Electric Bike for Adults</h2>
                <p class="product-price">$30,000.00</p>
                <p class="product-description">Electric Bike for Adults, 26'' 1000W Peak Ebike, Up to 50 Miles 21.7MPH Electric Mountain Bike with 48V 374.4WH Removable Battery, Adjustable Stem, Fenders, Lockable Suspension Fork, 21-Speed.</p>
                <div class="buttons">
                  <button id="add-to-cart" onclick="addToCart('Standard Electric Bike for Adults', 30000, 'Assets/Bike1_.jpg')">Add to Cart</button>
                </div>
              </div>
            </div>
            <div class="product-card">
              <div class="product-image">
                <img src="Assets/Bike2_.jpg" alt="Product Image">
              </div>
              <div class="product-details">
                <h2 class="product-title">Fat Tire Electric Bike for Adults</h2>
                <p class="product-price">$40,000.00</p>
                <p class="product-description">Electric Bike for Adults, Peak 1000W Ebike, 25MPH 60Miles Electric Mountain Bike, 26" Fat Tire Adult Electric Bicycle with 48V 13AH Battery, Rear Rack, 7 Speed, Front Suspension, Turn Signal</p>
                <div class="buttons">
                  <button id="add-to-cart" onclick="addToCart('Fat Tire Electric Bike for Adults', 40000, 'Assets/Bike2_.jpg')">Add to Cart</button>
                </div>
              </div>
            </div>
            <div class="product-card">
              <div class="product-image">
                <img src="Assets/Bike3_.jpg" alt="Product Image">
              </div>
              <div class="product-details">
                <h2 class="product-title">Funhang Electric Bike for Adults</h2>
                <p class="product-price">$40,000.00</p>
                <p class="product-description">Electric Bike for Adults, 1000W Peak Ebike, 21.7MPH 50Miles City Cruiser Ebikes, 26" Step Thru Electric Bicycle with 48V Removable Battery, Adjustable Stem, Rear Rack, Front Suspension,7 Speed</p>
                <div class="buttons">
                  <button id="add-to-cart" onclick="addToCart('Funhang Electric Bike for Adults', 40000, 'Assets/Bike3_.jpg')">Add to Cart</button>
                </div>
              </div>
            </div>
            <div class="product-card">
              <div class="product-image">
                <img src="Assets/Bike4_.jpg" alt="Product Image">
              </div>
              <div class="product-details">
                <h2 class="product-title">Ridstar Electric Bike for Adults</h2>
                <p class="product-price">$65,000.00</p>
                <p class="product-description">Electric Bike for Adults Q20, 2000/1500W, 37/30MPH,52V 40AH,48V/20AH E-Bike,30-180 Miles Electric Motorcycle, 20" Fat Tire Dirt Bike, UL2849 All Terrain for Mountains, Snow, Sand, Road</p>
                <div class="buttons">
                  <button id="add-to-cart" onclick="addToCart('Ridstar Electric Bike for Adults', 65000, 'Assets/Bike4_.jpg')">Add to Cart</button>
                </div>
              </div>
            </div>
            <div class="product-card">
              <div class="product-image">
                <img src="Assets/Bike5_.jpg" alt="Product Image">
              </div>
              <div class="product-details">
                <h2 class="product-title">Soleil01 Electric Bike for Adults</h2>
                <p class="product-price">$80,000.00</p>
                <p class="product-description">Soleil01 Electric-Dirt-Bike for Teens Adults, 14"/12" Fat Tire 2000W Electric-Motorcycle with 48V 21AH Battery Ebike 37MPH Hydraulic Brakes Mountain Off-Road EBike Fit Age 13+</p>
                <div class="buttons">
                  <button id="add-to-cart" onclick="addToCart('Soleil01 Electric Bike for Adults', 80000, 'Assets/Bike5_.jpg')">Add to Cart</button>
                </div>
              </div>
            </div>
            <div class="product-card">
              <div class="product-image">
                <img src="Assets/Bike6_.jpg" alt="Product Image">
              </div>
              <div class="product-details">
                <h2 class="product-title">Electric Bike for Adults</h2>
                <p class="product-price">$40,000.00</p>
                <p class="product-description">Electric Bike for Adults, 48V 18.2AH Electric Motorcycle, Long Seat Electric Bicycle Full Suspension 20" Fat Tire Ebike Max 28MPH& 30 Miles All Terrain E-Bike for Mountains, Snow, Sand, Road</p>
                <div class="buttons">
                  <button id="add-to-cart" onclick="addToCart('Electric Bike for Adults', 40000, 'Assets/Bike6_.jpg')">Add to Cart</button>
                </div>
              </div>
            </div>
            <div class="product-card">
              <div class="product-image">
                <img src="Assets/Bike7_.jpg" alt="Product Image">
              </div>
              <div class="product-details">
                <h2 class="product-title">GT73 Electric Dirt Bike</h2>
                <p class="product-price">$100,000.00</p>
                <p class="product-description">GT73 Electric Dirt Bike for Adults, 2000W Electric Dirtbike with 25 Inch Motorcycle Tires, 1747Wh Dual Battery Electric Bike, Max 37 MPH & 85 Mile Long Range, Dual Hydraulic Brakes & Full Suspension</p>
                <div class="buttons">
                  <button id="add-to-cart" onclick="addToCart('GT73 Electric Dirt Bike', 100000, 'Assets/Bike7_.jpg')">Add to Cart</button>
                </div>
              </div>
            </div>
              <div class="product-card">
                <div class="product-image">
                  <img src="Assets/Bikelock_.jpg" alt="Product Image">
                </div>
                <div class="product-details">
                  <h2 class="product-title">Bike Lock</h2>
                  <p class="product-price">$500.00</p>
                  <p class="product-description">Bike Lock, 3.2 FT Bike Chain Lock, 5-Digit Resettable Combination Heavy Duty Anti-Theft Bicycle Chain Lock for Bike, Ebike, Electric Scooter, Motorcycle, Door, Fence, Gate, Keyless, 6mm Thick</p>
                  <div class="buttons">
                    <button id="add-to-cart" onclick="addToCart('Bike Lock', 500, 'Assets/Bikelock_.jpg')">Add to Cart</button>
                  </div>
                </div>
              </div>
              <div class="product-card">
                <div class="product-image">
                  <img src="Assets/Bikebag_.jpg" alt="Product Image">
                </div>
                <div class="product-details">
                  <h2 class="product-title">Bike Bag</h2>
                  <p class="product-price">$1,000.00</p>
                  <p class="product-description">Bike Bag Phone Front Frame Bag, EVA Waterproof Bicycle Bag with TPU Touch Screen for Road Bike Electric Mountain Bike, Sturdy and Lightweight Top Tube Bag Compatible with Phones Below 6.9</p>
                  <div class="buttons">
                    <button id="add-to-cart" onclick="addToCart('Bike Bag', 1000,'Assets/Bikebag_.jpg' )">Add to Cart</button>
                  </div>
                </div>
              </div>
        </div>
        </td>

        <td align="left"  width="25%" cellpadding="20" valign="top" style="color: #99ddff;">
          <div class="cart">
            <div >
              <h2 align="center">Shopping Cart</h2><br>
              <ul id="cartItems"></ul><br>
              <div align="center">Total: $<span id="totalPrice">0.00</span></div><br>
              <div class="buttons">
                  <button onclick="checkout2()">Checkout Now!</button>
              </div>
            </div>
          </div>
        </td>
      </tr>
    </table>
      
    <script>
      // Array to hold cart items
      let cart = JSON.parse(localStorage.getItem("cart")) || []; // Load cart from localStorage or initialize as empty
    
      // Function to add items to the cart
      function addToCart(productName, productPrice, productImage) {
        console.log("Adding to cart:", productName, productPrice, productImage);

        // Retrieve current user
        const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
        if (!currentUser) {
            alert('You must be logged in to add items to the cart.');
            return;
        }

        const userTRN = currentUser.trn;

        // Retrieve existing cart data from localStorage
        let cartData = JSON.parse(localStorage.getItem('CartData')) || {};

        // Initialize cart for this user if it doesn't exist
        if (!cartData[userTRN]) {
            cartData[userTRN] = [];
        }

        // Check if the product already exists in the user's cart
        const existingItemIndex = cartData[userTRN].findIndex(item => item.name === productName);

        if (existingItemIndex !== -1) {
            // If the product exists, update the quantity
            cartData[userTRN][existingItemIndex].quantity += 1;
            console.log("Updated quantity for:", productName);
        } else {
            // If the product doesn't exist, add it to the cart
            cartData[userTRN].push({
                name: productName,
                price: productPrice,
                image: productImage,
                quantity: 1
            });
            console.log("Added new item to cart:", productName);
        }

        // Save the updated cart data to localStorage
        localStorage.setItem('CartData', JSON.stringify(cartData));
        console.log("Cart saved to localStorage:", cartData);

        // Update the cart display
        updateCart();
      }
    
      // Function to update the cart display
      function updateCart() {
        console.log("Updating cart display...");

        // Retrieve current user
        const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
        if (!currentUser) {
            alert('You must be logged in to view the cart.');
            return;
        }

        const userTRN = currentUser.trn;

        // Retrieve cart data for this user
        const cartData = JSON.parse(localStorage.getItem('CartData')) || {};
        const userCart = cartData[userTRN] || [];

        const cartItems = document.getElementById('cartItems');
        const totalPrice = document.getElementById('totalPrice');
        const cartCount = document.getElementById('cart-count');

        // Clear the cart display
        cartItems.innerHTML = '';

        // Initialize total and itemCount
        let total = 0;
        let itemCount = 0;

        // Populate cart items
        userCart.forEach(item => {
            const li = document.createElement('li');
            li.textContent = `${item.name} - $${item.price} x ${item.quantity}`;
            cartItems.appendChild(li);
            total += item.price * item.quantity;
            itemCount += item.quantity;
        });

        // Update total price
        totalPrice.textContent = total.toFixed(2);

        // Update cart count if element exists
        if (cartCount) {
            cartCount.textContent = itemCount;
        }

        console.log("Cart display updated:", { total, itemCount });
      }
    
      // Function to handle checkout
      function checkout() {
        console.log("Proceeding to checkout...");

        // Retrieve current user
        const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
        if (!currentUser) {
            alert('You must be logged in to proceed to checkout.');
            return;
        }

        const userTRN = currentUser.trn;

        // Retrieve cart data for this user
        const cartData = JSON.parse(localStorage.getItem('CartData')) || {};
        const userCart = cartData[userTRN] || [];

        if (userCart.length === 0) {
            alert('Your cart is empty!');
            return;
        }

        // Store data in localStorage
        localStorage.setItem('CartData', JSON.stringify(cartData));

        // Redirect to the cart page
        window.location.href = "Cart.html";
      }

      // Function to handle checkout
      function checkout2() {
        console.log("Proceeding to checkout...");

        // Retrieve current user
        const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
        if (!currentUser) {
            alert('You must be logged in to proceed to checkout.');
            return;
        }

        const userTRN = currentUser.trn;

        // Retrieve cart data for this user
        const cartData = JSON.parse(localStorage.getItem('CartData')) || {};
        const userCart = cartData[userTRN] || [];

        if (userCart.length === 0) {
            alert('Your cart is empty!');
            return;
        }

        // Store data in localStorage
        localStorage.setItem('CartData', JSON.stringify(cartData));

        // Redirect to the checkout page
        window.location.href = "Checkout.html";
      }
    
      // Load cart data and update display on page load
      window.onload = function () {
        console.log("Page loaded. Updating cart display...");
        updateCart();
      };

      // Validate session on page load
      window.addEventListener('DOMContentLoaded', () => {
        const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
        
        if (!currentUser) {
            // Redirect to login if no active session
            window.location.href = 'Login.html';
        }
      });

      window.addEventListener('DOMContentLoaded', () => {
            const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
            if (currentUser) {
                const navbar = document.querySelector('.navbar .links');
                const userGreeting = document.createElement('li');
                userGreeting.textContent = `Hi, ${currentUser.name}`;
                userGreeting.style.color = '#fff';
                userGreeting.style.fontWeight = 'bold';
                userGreeting.style.marginLeft = '0px'; // Adjust spacing
                userGreeting.style.whiteSpace = 'nowrap'; // Prevent text wrapping
                navbar.appendChild(userGreeting);
            }
        });
    </script>
  </body>
</html>
